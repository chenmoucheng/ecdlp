\section{Experimental results}
\label{sec:experiment}

We have conducted a set of experiments to compare the difficulty of
solving ECDLP for four different curves (Hessian, Montgomery, twisted
Edwards, and Weierstrass) over \F{q^n}.
%
To make an apple-to-apple comparison, we use curves in different forms
but are nonetheless isomorphic to one another, as explained in
Section~\ref{sec:isomorphisms}.
%
In other words, the curves in different forms have the same
j-invariant, and we consider the ECDLP in the same (largest)
prime-order subgroup in each of the experiments.

In these experiment, we focus on the cost of F4 algorithm for solving
polynomial system, which is the bottleneck computation in finding
relations of point decomposition.
%
More precisely, we consider the polynomial systems obtained after
rewriting using the elementary symmetric polynomials and applying the
Weil restriction technique to summation polynomials, as described in
Section~\ref{sec:weil-restriction}.
%
All our experiment are done using the MAGMA computation algebra
system, version 2.23-1, on a single core of an Intel Xeon CPU E7-4830
v4 running at 2~GHz.

The main cost metrics are running time, Matcost, and the maximum step
degree reached during the execution of the F4 algorithm.
%
This is usually referred to as the ``degree of regularity'' in the
literature~\cite{DBLP:conf/indocrypt/GalbraithG14}, which provides an
upper bound for the size of Macaulay matrices during the execution of
the F4 algorithm.
%
Here ``Matcost'' is output by the MAGMA implementation of the F4
algorithm, which is supposed to represent the cost of linear algebra
in the algorithm.

We first present the results for the case of $n=5$.
%
Here our factor base is taken such that $V$ is the base field \F q of
\F{q^n}.
%
\input{result1}

We can clearly see that the solving time for twisted Edwards curve is
much faster than the other three curves for different $q$ and $m$.
%
We suspect that this is due to the difference in the sparsity of the
resulted polynomial systems.
%
Table~\ref{tb:terms} shows how the sparsity before and after Weil
restriction for each curves in the case of $m=2,3,4$.
%
There are $n$ equations after Weil restriction, so those numbers are
the average.
%
We also include the maximum number of terms for a polynomial of degree
$2^{(m+1)-2}$ in $m$ variables.
%
We can see that the number of terms for twisted Edwards curve is
significantly fewer than the other three curves in all cases.
%
Naturally, this could lead to smaller matrices and hence faster
solving time with the F4 algorithm.

\input{result2}

We further analyze which terms are missing from the summation
polynomials for curves in different forms.
%
We classify terms into odd vs.~even degrees.
%
Recall that the polynomials are expressed using elementary symmetric polynomials 
$e_1, \dots ,e_m$.
%
Therefore, a monomial $e_i^j$ has odd degree only if both $i$ and $j$
are odd.
%
For $m=2$, it is interesting that there are no monomials of odd degree
only for twisted Edwards curve.
%
In other words, there are no terms originated from monomial such as
$e_1$ or $e_1e_2$.
%
This is because the addition formula for twisted Edwards curve, based
on which the summation polynomial is derived, consists of only even
terms.
%
Therefore, when one of the 3 variables in the summation polynomial is
substituted with the point we want to decompose, the odd-degree terms
all vanish.

For $m=3$, we use summation polynomial with 4 variables, which is
obtained by taking the resultant of two summation polynomials 
with 3 variables.
%
Therefore, there are some odd terms such as $e_3$ or $e_2^2e_3$.
%
For $m=4$, there is also no terms with odd degree.
%
Through calculating resultant recursively, two variables are
eliminated, and it preserves all terms to even degree.

