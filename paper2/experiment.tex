\section{Experimental results and concluding remarks}
\label{sec:experiment}

We have conducted a set of experiments to compare the difficulty of
solving ECDLP for four different curves (Hessian, Weierstrass,
Montgomery, and twisted Edwards) over \F{p^n}.
%
To make an apple-to-apple comparison, we use curves in different forms
but are nonetheless isomorphic to one another over \F{p^n}, as
explained in Section~\ref{sec:isomorphism}.
%
In other words, the curves in different forms have the same
j-invariant, and we consider the ECDLP in the same (largest)
prime-order subgroup in each of the experiments.

As explained in Section~\ref{sec:index-calculus-ecdlp}, we focus on
the PDP computation in these experiments, as the other bottleneck
computation, the linear algebra step is already well understood.
%
We focus on the bottleneck computation in PDP, namely, the cost of the
F4 algorithm for computing Gr\"obner bases for polynomial systems
obtained after rewriting using the elementary symmetric polynomials
and applying the Weil restriction technique to summation polynomials.
%
This way we will be taking advantage of the symmetry of $S_m$ acting
on point decompositions.
% 
However, we \emph{did not} exploit the symmetry of group actions on
point decomposition except the action of $S_m$.
%
This is because we want to compare the \emph{intrinsic} computational
complexity of solving PDP for various curves and hence can only
consider the symmetry that is present in \emph{all} curves.
%
Exploiting further curve-specific symmetry whenever possible will
result in further speed-up, but it would be independent of our
findings here.

All our experiment are done using the MAGMA computation algebra system
(version 2.23-1) on a single core of an Intel Xeon CPU E7-4830 v4
running at 2~GHz.
%
The main cost metrics are running time, Matcost, and the maximum step
degree reached during the execution of the F4 algorithm.
%
The last metric is usually referred to as the ``degree of regularity''
in the literature~\cite{DBLP:conf/indocrypt/GalbraithG14}, which
provides an upper bound for the size of the Macaulay submatrices
involved in the process.
%
The ``Matcost'' is a number output by the MAGMA implementation of the
F4 algorithm and provides an estimate of the linear algebra cost
during the execution of the F4 algorithm.

Lastly, we report ``rank,'' or the number of linearly independent
relations we can get once successfully solving a PDP instance for each
of the four curves.
%
We note that the action of $S_m$ will not contribute to rank, as
permutations of a point decomposition do not give any new relations.
%
As previewed in Section~\ref{sec:symmetry-decomposition-probability},
we would expect that the effect of the decrease in decomposition
probability due to additional symmetry in a factor base $\mathcal F$
can be offset by that of the increase in number of solutions.
%
Again using the example of group action of adding $T_2$ in
Section~\ref{sec:exploit-symmetry}, if we could get $2^{n-1}$
solutions, then the loss of the factor of $2^{n-1}$ in decomposition
probability would be compensated, and everything would be the same as
if there were no such symmetry.

Unfortunately, this proposition is \emph{false} in general.
%
Consider an example of $n=4$.
%
Let $Q_i=P_i+ T_2$ for $i=1,2,3,4$.
%
We can write down all $2^{n-1}=8$ possible ways of point decomposition
under this group action:
%
\[ \begin{aligned}
P_1 + P_2 + P_3 + P_4 = & Q_1 + Q_2 + P_3 + P_4 \\
= Q_1 + P_2 + Q_3 + P_4 = & Q_1 + P_2 + P_3 + Q_4 \\
= P_1 + Q_2 + Q_3 + P_4 = & P_1 + Q_2 + P_3 + Q_4 \\
= P_1 + P_2 + Q_3 + Q_4 = & Q_1 + Q_2 + Q_3 + Q_4.
\end{aligned} \]
%
It is easy to find that we have only 5 linearly independent relations
from these 8 relations, as there are nontrivial linear combinations
summing to zero, e.g.:
\[ (P_1 + P_2 + P_3 + P_4) - (Q_1 + Q_2 + P_3 + P_4) - (P_1 + P_2 +
  Q_3 + Q_4) + (Q_1 + Q_2 + Q_3 + Q_4) = \mathcal O.\]

We present our experimental results for the case of $n=5$.
%
Here our factor base is to take $V$ as the base field \F p of \F{p^n}.
%
\input{result1}

We can clearly see that the PDP solving time for twisted Edwards curve
is much faster than the other three curves for different $q$ and $m$.
%
As explained in
Section~\ref{sec:twisted-edwards-summation-polynomial}, this is due to
the difference in the sparsity of the resulted polynomial systems.
%
Table~\ref{tb:terms} shows the sparsity before and after Weil
restriction for each curves in the case of $m=2,3,4$.
%
\input{result2}
%
As there are $n$ equations after Weil restriction, we are only showing
the average.  the average.
%
We also include the maximum number of terms for a polynomial of degree
$2^{(m+1)-2}$ in $m$ variables.
%
We can see that the number of terms for twisted Edwards curve is
significantly fewer than the other three curves in all cases.
%
Naturally, this could lead to smaller matrices and hence faster
solving time with the F4 algorithm.

% We further analyze which terms are missing from the summation
% polynomials for curves in different forms.
% %
% We classify terms into odd vs.~even degrees.
% %
% Recall that the polynomials are expressed using elementary symmetric polynomials 
% $e_1, \dots ,e_m$.
% %
% Therefore, a monomial $e_i^j$ has odd degree only if both $i$ and $j$
% are odd.
% %
% For $m=2$, it is interesting that there are no monomials of odd degree
% only for twisted Edwards curve.
% %
% In other words, there are no terms originated from monomial such as
% $e_1$ or $e_1e_2$.
% %
% This is because the addition formula for twisted Edwards curve, based
% on which the summation polynomial is derived, consists of only even
% terms.
% %
% Therefore, when one of the 3 variables in the summation polynomial is
% substituted with the point we want to decompose, the odd-degree terms
% all vanish.

% For $m=3$, we use summation polynomial with 4 variables, which is
% obtained by taking the resultant of two summation polynomials 
% with 3 variables.
% %
% Therefore, there are some odd terms such as $e_3$ or $e_2^2e_3$.
% %
% For $m=4$, there is also no terms with odd degree.
% %
% Through calculating resultant recursively, two variables are
% eliminated, and it preserves all terms to even degree.

Last but not least, we report rank information in each of the four
curves under invesigation.
%
As explained in Section~\ref{sec:isomorphism}, the factor bases for
Montgomery and twisted Edwards curves are invariant under addition of
2-torsion point.
%
For $m=3$, we achieve maximum rank of $2^{m-1}=4$.
%
For $m=4$, as we have explained earlier in this section, we can only
have rank $5$, which is strictly less than the maximum possible rank
$2^{m-1}=8$.

Finally, we note that we have not exploited any symmetry for Hessian
curves in our experiments.
%
However, the rank for experiments with Hessian curves is always 1.
%
This shows that the factor base we have chosen for Hessian curves is
\emph{not} invariant under addition of small torsion points, as the
rank would be $>1$ were it the case.





